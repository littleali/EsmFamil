<div class="jumbotron room-features-list-box" >
  <div class="container ">
    <div class="row">
      <div class = "list-header">
        مشخصات اتاق
      </div>
      <div class="well  " id="room-well">
        <div class="row adaptable_font">
          <div class="col-md-3 font-medium">
            اتاق فعال
            <% if @room.enabled? %>
                است
            <% else %>
                نیست
            <% end %>
          </div>
          <div class="col-md-3 font-medium">
            ظرفیت اتاق: <%= @room.capacity %> نفر
          </div>
          <div class="col-md-3 font-medium">
            مدیر اتاق: <%= @room.admin.user.username %>
          </div>
          <div class="col-md-3 font-medium">
            نام اتاق: <%= @room.name %>
          </div>
        </div>
      </div>
    </div>
    <div class = "row">
      <div class="col-md-4">
      <div class = "list-table">
        <div class = "list-row">
          <%= link_to 'بازگشت به لیست اتاق‌ها', rooms_path, method: :get, :class => "" %>
          </div>
        <div class = "list-row">
          <%= link_to 'مرا به این اتاق اضافه کن', "/rooms/#{@room.id}/add_member/#{current_user.profile.id}", :method => :patch, :remote => true %>

        </div>
        <div class = "list-row">
          <% if current_user.id == @room.admin.user.id %>
              <%= link_to 'این اتاق را حذف کن', @room, method: :delete, data: {confirm: 'مطمئن هستید؟'}%>
          <% end %>

        </div>
        </div>
      </div>
      <div class="col-md-4"> </div>
      <div class="col-md-4">
        <div class="panel panel-primary panel-default" >
          <div class="panel-heading panel-heading-custom">لیست اعضای اتاق (<%= @room.players.size %> نفر)</div>
          <div class="panel-body">
            <% if @room.players.size > 0 %>
                <table class="table table-hover table-striped">
                  <tbody id="room_tbody_<%=@room.id%>">
                  <% @room.players.each do |player| %>
                        <%= render :partial => 'rooms/member', :locals => {:room => @room, :player => player} %>
                  <% end %>
                  </tbody>
                </table>
            <% end %>
          </div>
        </div>
      </div>

      </div>
    <!--<div class="row">-->
      <!--<div class="col-md-offset-4">-->
        <!--&lt;!&ndash;<div class="panel panel-info">&ndash;&gt;-->
        <!--&lt;!&ndash;<div class="panel-heading">سابقه‌ی بازی‌های اتاق</div>&ndash;&gt;-->
        <!--&lt;!&ndash;<div class="panel-body"></div>&ndash;&gt;-->
        <!--&lt;!&ndash;</div>&ndash;&gt;-->

      <!--</div>-->
      <!--<div class="col-md-offset-4">-->
        <!--&lt;!&ndash;<div class="panel panel-default">&ndash;&gt;-->
        <!--&lt;!&ndash;<div class="panel-heading">گفت‌وگوها</div>&ndash;&gt;-->
        <!--&lt;!&ndash;<div class="panel-body"></div>&ndash;&gt;-->
      <!--</div> -->
      <!--<div class="col-md-4">-->

      <!--</div>-->
    <!--</div>-->

    </div>
  </div>
</div>



<%= %>
<!--link_to 'Add to this room', {:controller => :rooms, :action => :add_member, :room_id => @room.id.to_s, :profile_id => current_user.profile.id.to_s, :method => :patch} %>-->

<script type="text/javascript">

    window.client.subscribe('/rooms/<%=@room.id%>', function (payload) {
        if (payload.action == 'kick'){
            var element = $('#tr_'+payload.player_id);
            element.remove();
        }

        else
            $("#room_tbody_<%=@room.id%>").append(" <tr id='tr_" + payload.player_id + "'>" +
                "<td>" + payload.player_username + "</td>" +
        "<td>" + "<a class='kick-out-link' confirm='آیا مطمئن هستید?' data-remote='true' data-method='delete' href='/rooms/<%=@room.id%>/kick_out/" + payload.player_id +  "' rel='nofollow'>حذف کاربر</a>" + "</td><tr>");
    });
</script>
